# Операционные системы UNIX/Linux (Базовый)


## Оглавление
[Часть 1. Установка ОС](#часть-1-установка-ос)  
[Часть 2. Создание пользователя](#часть-2-создание-пользователя)  
[Часть 3. Настройка сети ОС](#часть-3-настройка-сети-ос)  
[Часть 4. Обновление ОС](#часть-4-обновление-ос)  
[Часть 5. Использование команды  sudo](#часть-5-использование-команды-sudo)  
[Часть 6. Установка и настройка службы времени](#часть-6-установка-и-настройка-службы-времени)  
[Часть 7. Установка и использование текстовых редакторов](#часть-7-установка-и-использование-текстовых-редакторов)  
[Часть 8. Установка и базовая настройка сервиса SSHD](#часть-8-установка-и-базовая-настройка-сервиса-sshd)   
[Часть 9. Установка и использование утилит top, htop](#часть-9-установка-и-использование-утилит-top-htop)   
[Часть 10. Использование утилиты fdisk](#часть-10-использование-утилиты-fdisk)   
[Часть 11. Использование утилиты df](#часть-11-использование-утилиты-df)    
[Часть 12. Использование утилиты du](#часть-12-использование-утилиты-du)    
[Часть 13. Установка и использование утилиты ncdu](#часть-13-установка-и-использование-утилиты-ncdu)    
[Часть 14. Работа с системными журналами](#часть-14-работа-с-системными-журналами)     
[Часть 15. Использование планировщика заданий CRON](#часть-15-использование-планировщика-заданий-cron)    


## Часть 1. Установка ОС

Установлена `Ubuntu 20.04 Server LTS` без графического интерфейса `cat /etc/issue`

![данные о системе](<Screenshots/Part 1_1.png>)

## Часть 2. Создание пользователя

Создаю нового пользователя командой `useradd 'new_man'`

![добавление нового пользователя](<Screenshots/Part 2_1.png>)

Добавляю пользователя в группу adm `usermod -aG adm`

![добавление пользователя в группу](<Screenshots/Part 2_2.png>)

Вывод команды `cat /etc/passwd`

![вывод команды "cat /etc/passwd"](<Screenshots/Part 2_3.png>)

## Часть 3. Настройка сети ОС
##### 3.1. Задаем название машины вида user-1

Меняю имя хоста `hostnamectl set-hostname user-1` и проверяю изменения

![меняем имя хоста](<Screenshots/Part 3_1.png>)

Перезапускаю систему `reboot now`

##### 3.2. Устанавливаем временную зону, соответствующую текущему местоположению

Устанавливаю временную зону `timedatectl set-timezone Europe/Moscow`

![установка временной зоны](<Screenshots/Part 3_2.png>)

##### 3.3. Выводим названия сетевых интерфейсов с помощью консольной команды

Вывожу названия сетевых интерфейсов `ip a`

![вывод названий сетевых интерфейсов](<Screenshots/Part 3_3.png>)

>lo (loopback device) – виртуальный интерфейс, присутствующий по умолчанию в любом Linux. Он используется для отладки сетевых программ и запуска серверных приложений на локальной машине. С этим интерфейсом всегда связан адрес 127.0.0.1. У него есть dns-имя – localhost.

##### 3.4. Используя консольную команду, получаем ip адрес устройства, на котором работаем, от DHCP сервера

Используя команду `ip address`, мы сможем получить ip адрес устройства, на котором работаем, от DHCP сервера  
Команда `hostname -I` покажет все сетевые адреса хоста (системы), кроме интерфейса loopback

![вывод информации об ip адресе](<Screenshots/Part 3_3_0.png>)

>DHCP (англ. Dynamic Host Configuration Protocol — протокол динамической настройки узла) — прикладной протокол, позволяющий сетевым устройствам автоматически получать IP-адрес и другие параметры, необходимые для работы в сети TCP/IP. Данный протокол работает по модели «клиент-сервер». Для автоматической конфигурации компьютер-клиент на этапе конфигурации сетевого устройства обращается к так называемому серверу DHCP и получает от него нужные параметры. Сетевой администратор может задать диапазон адресов, распределяемых сервером среди компьютеров. Это позволяет избежать ручной настройки компьютеров сети и уменьшает количество ошибок. Протокол DHCP используется в большинстве сетей TCP/IP.

##### 3.5. Определяем и выводим на экран внешний ip-адрес шлюза (ip) и внутренний IP-адрес шлюза, он же ip-адрес по умолчанию (gw)

Определяю внешний ip `curl ifconfig.me`, и внутренний `ip r`

![внешний ip-адрес шлюза (ip) и внутренний IP-адрес шлюза](<Screenshots/Part 3_4.png>)

##### 3.6. Задаем статичные настройки ip, gw, dns

Перехожу к файлу конфигурации `nano /etc/netplan/00-installer-config.yaml`, вношу необходимые изменения

![вносим изменения в файл конфигурации](<Screenshots/Part 3_5.png>)

Запускаю команду `netplan apply`

##### 3.7. Перезагружаем виртуальную машину. Убеждаемся, что статичные сетевые настройки (ip, gw, dns) соответствуют заданным в предыдущем пункте

Перезапускаю машину командой `reboot now`

Пингую 8.8.8.8 и 1.1.1.1

![вывод информации о пропинговании удаленых хостов ya.ru и 1.1.1.1](<Screenshots/Part 3_6.png>)

## Часть 4. Обновление ОС
##### Обновляем системные пакеты до последней на момент выполнения задания версии

Запускаю обновление командой `sudo apt update`

![информация об обновлении](<Screenshots/Part 4_1.png>)

## Часть 5. Использование команды  sudo

>sudo (англ. Substitute User and do, дословно «подменить пользователя и выполнить») — программа для системного администрирования UNIX-систем, позволяющая делегировать те или иные привилегированные ресурсы пользователям с ведением протокола работы. Основная идея — дать пользователям как можно меньше прав, при этом достаточных для решения поставленных задач. Команда sudo предоставляет возможность пользователям выполнять команды от имени суперпользователя root, либо других пользователей.

##### Разрешаю пользователю, созданному в части 2, выполнять команду sudo

Добавляю пользователя в группу sudo командой `sudo usermod -aG sudo`

![добавляем пользователя в группу sudo](<Screenshots/Part 5_1.png>)

Переключаюсь на пользователя "new_man" командой `su` и меняю имя хоста

![меняем имя хоста от имени второго пользователя](<Screenshots/Part 5_2.png>)

## Часть 6. Установка и настройка службы времени
##### Настройка службы автоматической синхронизации времени

Вывожу время часового пояса, в котором нахожусь `timedateclt`, `timedateclt show`

![вывод времени и часового пояса](<Screenshots/Part 6_1.png>)

## Часть 7. Установка и использование текстовых редакторов
##### Устанавливаю текстовые редакторы VIM (+ любые два по желанию NANO, MCEDIT, JOE и т.д.)

Устанавливаю vim `sudo apt install vim`, nano `sudo apt install nano`, joe `sudo apt install joe`

![установка vim, nano, joe](<Screenshots/Part 7_1.png>)

##### Редактор vim

Создаю файл `vim test_VIM.txt`, записываю ник и выхожу с сохранением

![работа в вим с сохранением](<Screenshots/Part 7_2.png>)

- :wq - выйти с сохранением

Повторно открываю файл, заменяю ник на "21 school 21" и выхожу без сохранения

![работа в вим без сохранения](<Screenshots/Part 7_5.png>)

- :q! - выйти без сохранения

Повторно открываю файл, заменяю ник на "21 school 21" с помощью поиска нахожу нужное слово

![работа в вим по поиску](<Screenshots/Part 7_8.png>)

- :s/School/maks - поиск и замена

![работа в вим по поиску и замене](<Screenshots/Part 7_9.png>)

##### Редактор nano

Создаю файл `nano test_nano.txt`, записываю ник и выхожу с сохранением

![работа в нано с сохранением](<Screenshots/Part 7_3.png>)

- ctrl + x - выход из редактора. y - соглашаемся с сохранением

Повторно открываю файл, заменяю ник на "21 school 21" и выхожу без сохранения

![работа в нано без сохранения](<Screenshots/Part 7_6.png>)

- ctrl + x - выход из редактора. n - отказываемся от сохранением

Повторно открываю файл, заменяю ник на "21 school 21" с помощью поиска

![работа в нано по поиску и замене](<Screenshots/Part 7_11.png>)

- ctrl + \ - поиск и замена

##### Редактор joe

Создаю файл `nano test_joe.txt`, записываю ник и выхожу с сохранением

![работа в джо с сохранением](<Screenshots/Part 7_4.png>)

- ctrl + k + q - выход из редактора. y - соглашаемся с сохранением

Повторно открываю файл, заменяю ник на "21 school 21" и выхожу без сохранения

![работа в джо без сохранения](<Screenshots/Part 7_7.png>)

- ctrl + k + q - выход из редактора. n - отказываемся от сохранением

Повторно открываю файл, заменяю "School" на ник с помощью поиска

![работа в джо по поиску и замене](<Screenshots/Part 7_13.png>)

- ctrl + k + f - поиск и замена

## Часть 8. Установка и базовая настройка сервиса SSHD
##### 8.1 Установка службы SSHd

Устанавливаю SSHd командой `sudo apt install openssh-server`

##### 8.2 Добавление автостарта службы при загрузке системы

Добавляю автозапуск службы командой `sudo systemctl enable ssh`

![автозапуск ssh](<Screenshots/Part 8_2.png>)

Проверяю, работает ли служба `systemctl status ssh`

![проверка работы ssh](<Screenshots/Part 8_3.png>)

##### 8.3 Перенастройка службы SSHd на порт 2022

Меняю конфиг `nano /etc/ssh/sshd_config`

![файл конфигурации ssh](<Screenshots/Part 8_4.png>)




##### 8.4 Используя команду ps, показать наличие процесса sshd. Для этого к команде нужно подобрать ключи

>ps -e - показывает все запущенные процессы

Смотрю на наличие процесса `ps -e | grep sshd`

![проверка наличия процесса sshd](<Screenshots/Part 8_5.png>)

##### 8.5 Перезагрузить систему

Перезапускаем `reboot now`

Устанавливаем netstat `apt install net-tools`

Выполняю `netstat -tan`

![netstat -tan](<Screenshots/Part 8_6.png>)

> netstat - отображение статистики сетевых соединений.

- -tan:
- -a - Показывать состояние всех сокетов; обычно сокеты, используемые серверными процессами, не показываются
- -n - Показывать сетевые адреса как числа. netstat обычно показывает адреса как символы
- -t - Отображать TCP подключения
- Proto - Содержит тип протокола
- Recv-Q - Счётчик байтов не скопированных программой пользователя из этого сокета
- Send-Q - Счётчик байтов, не подтверждённых удалённым узлом
- Local Address - Адрес и номер порта локального конца сокета
- Foreign Address - Адрес и номер порта удалённого конца сокета
- State - Состояние сокета
- LISTEN - Сокет ожидает входящих подключений
- SYN_SENT - Сокет, находящийся в режиме активной попытки установки подключения
- 0.0.0.0 - Немаршрутизируемый адрес IPv4, который используется в качестве адреса по умолчанию или адреса-заполнителя


## Часть 9. Установка и использование утилит top, htop
##### Установка и запуск утилиты top и htop

Устанавливаю утилиты `apt install procps`

Вывод утилиты top

![вывод утилиты top](<Screenshots/Part 9_1.png>)

- uptime: 7 min
- кол-во авторизованных пользователей: 1 user
- общую загрузку системы: 0.03, 0.03, 0.00
- общее количество процессов: 112 total, 1 running, 111 sleeping, 0 stopped, 0 zombie
- загрузку cpu: %Cpu(s): 0.0 us, 0.0 sy, 0.0 ni, 100.0 id, 0.0 wa, 0.0 hi, 0.0 si, 0.0 st
- загрузку памяти: MiB Mem : 1963.9 total, 1444.7 free, 179.7 used, 339.4 buff/cache
- pid процесса занимающего больше всего памяти: 659
- pid процесса, занимающего больше всего процессорного времени: 1085

Вывод утилиты htop отсортированный по PID

![вывод утилиты htop](<Screenshots/Part 9_4.png>)

Вывод утилиты htop отсортированный по PERCENT_CPU

![вывод утилиты htop](<Screenshots/Part 9_5.png>)

Вывод утилиты htop отсортированный по PERCENT_MEM

![вывод утилиты htop](<Screenshots/Part 9_6.png>)

Вывод утилиты htop отсортированный по TIME

![вывод утилиты htop](<Screenshots/Part 9_7.png>)

Вывод утилиты htop отфильтрованному для процесса sshd

![вывод утилиты htop](<Screenshots/Part 9_8.png>)

Вывод утилиты htop с процессом syslog, найденным, используя поиск

![вывод утилиты htop](<Screenshots/Part 9_9.png>)

Вывод утилиты htop с добавленным выводом hostname, clock и uptime

![вывод утилиты htop](<Screenshots/Part 9_10.png>)

## Часть 10. Использование утилиты fdisk

Запуск утилиты `fdisk -l`

![запуск fdisk -l](<Screenshots/Part 10_1.png>)

- название жесткого диска: VBOX HARDDISK
- размер: 25 GiB
- количество секторов: 52428800

Размер swap: 2.0 GiB

![запуск fdisk -l](<Screenshots/Part 10_2.png>)

## Часть 11. Использование утилиты df

>df (аббревиатура от disk free) — показывает список всех файловых систем по именам устройств, сообщает их размер, занятое и свободное пространство и точки монтирования.

##### 11.1 Запустить команду df

Запуск утилиты `df`

![запуск df](<Screenshots/Part 11_1.png>)

Отчет для корневого раздела(/):
- размер раздела: 11758760
- размер занятого пространства: 5625588
- размер свободного пространства: 5514064
- процент использования: 51%

Единицы измерения: 1K

##### 11.2 Запустить команду df -Th

Запуск утилиты `df -Th`

>-h - выводить размеры в читаемом виде, в мегабайтах или гигабайтах 
>-T - тип файловой системы.

![запуск df -Th](<Screenshots/Part 11_2.png>)

Отчет для корневого раздела(/):
- размер раздела: 12G
- размер занятого пространства: 5.4G
- размер свободного пространства: 5.3G
- процент использования: 51%

Тип файловой системы для раздела: ext4

## Часть 12. Использование утилиты du

>du (аббревиатура от англ. disk usage) — стандартная Unix-программа для оценки занимаемого файлового пространства. По умолчанию показывает размер файлового пространства, занимаемого каждым файлом и каталогом в текущем каталоге.

##### 12.1 Запуск команды du

Запускаю команду `du`

![запуск команды du](<Screenshots/Part 12_1.png>)

##### 12.2 Вывод размера папок /home, /var, /var/log (в байтах, в человекочитаемом виде)

Добавляю флаги и запускаю `du -sh /home /var /var/log`

![запуск команды du с флагами -sh](<Screenshots/Part 12_2.png>)

##### 12.3 Вывожу размер всего содержимого в /var/log (не общее, а каждого вложенного элемента, используя *)

Запускаю команду `du -sh /var/log/*`

![запуск команды du с флагами -sh](<Screenshots/Part 12_3.png>)

## Часть 13. Установка и использование утилиты ncdu

##### 13.1 Устанавливаю утилиту ncdu

Устанавливаю ncdu `apt install ncdu`

##### 13.2 Вывожу размер папок /home, /var, /var/log

Вывожу размер папки /home `sudo ncdu /home`

![вывод ncdu /home](<Screenshots/Part 13_1.png>)

Вывожу размер папки /var `sudo ncdu /var`

![вывод ncdu /var](<Screenshots/Part 13_2.png>)

Вывожу размер папки /var/log `sudo ncdu /var/log`

![вывод ncdu /var/log](<Screenshots/Part 13_3.png>)

## Часть 14. Работа с системными журналами

Открываю для просмотра `nano /var/log/dmesg`

>dmesg — в этом логе хранится информация о загрузке ядра и драйверов оборудования. В момент загрузки системы записывается вся основная информация, имеющая к ней отношение.

![логи dmesg](<Screenshots/Part 14_1.png>)

Открываю для просмотра `nano /var/log/syslog`

>syslog - глобальные системные журналы операционной системы linux. Сюда пишутся события загрузки, ядра системы, системы инициализации systemd и т.д.

![логи syslog](<Screenshots/Part 14_2.png>)

Открываю для просмотра `nano /var/log/auth.log`

>auth.log — лог авторизации и аутентификации в системе, в том числе ssh.

![логи auth.log](<Screenshots/Part 14_3.png>)

- Время последней успешной авторизации: 21 Feb 10:27:18 
- Имя пользователя: newman 
- Метод входа в систему: TTY=tty1  

##### Перезапуск sshd

Перезапускаю sshd `systemctl restart sshd`

Логи о перезапуске sshd

![логи о перезапуске sshd](<Screenshots/Part 14_4.png>)

## Часть 15. Использование планировщика заданий CRON

>Cron (Command Run ON) — система для автоматического запуска программ и скриптов на сервере в определённое время.

##### 15.1 Используя планировщик заданий, запускаю команду uptime через каждые 2 минуты

Вхожу в журнал для записи заданий `crontab -e` и добавляю задание `*/2 * * * * uptime`

![входим в журнал](<Screenshots/Part 15_1.png>)

Смотрю логи `nano /var/log/syslog`

![сморю логи](<Screenshots/Part 15_2.png>)

Список текущих задач для CRON `crontab -l`

![список текущих задач для CRON](<Screenshots/Part 15_3.png>)

##### 15.2 Удаляю все задания из планировщика заданий

Удаляю все задания и проверяю список задач `crontab -r` `crontab -l`

![удаляю задания и проверяю список задач](<Screenshots/Part 15_4.png>)
